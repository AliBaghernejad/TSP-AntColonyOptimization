namespace AntColonyOptimization

open AntColonyOptimization.RequiredTypes
open AntColonyOptimization
open AntColonyOptimization.Settings

module Helpers = 
    let x=[|82; 91; 12; 92; 63; 9; 28; 55; 96; 97; 15; 98; 96; 49; 80; 14; 42; 92; 80; 96|];
    
    let y=[|66; 3; 85; 94; 68; 76; 75; 39; 66; 17; 71; 3; 27; 4; 9; 83; 70; 32; 95; 3|];



//    let distanceGenerator cityCount  = 
//       [| 
//            [| 0.0; 63.6396103067893; 72.5327512231544; 29.7321374946370; 19.1049731745428; 73.6817480791546; 54.7448627726840; 38.1837661840736; 14.0; 51.2445119012758; 67.1863081289633; 65.0; 41.4366987102013; 70.2353187506115; 57.0350769263968; 70.0927956355002; 40.1995024844836; 35.4400902933387; 29.0688837074973; 64.5368112010502|]
//            [|63.6396103067893; 0.0; 113.863953909918; 91.0054943396277; 70.7742891168820; 109.786155775671; 95.6713123146118; 50.9116882454314; 63.1981012372998; 15.2315462117278; 101.980390271856; 7.0; 24.5153013442625; 42.0119030752000; 12.5299640861417; 111.036030188403; 83.0060238777885; 29.0172362570938; 92.6552750791880; 5.0|]
//            [| 72.5327512231544; 113.863953909918; 0.0; 80.5046582503149; 53.7587202228625; 9.48683298050514; 18.8679622641132; 62.9682459657247; 86.1220064791805; 108.853112036358; 14.3178210632764; 118.827606220104; 102.078401241399; 89.0505474435727; 101.980390271856; 2.82842712474619; 33.5410196624968; 95.9635347410671; 68.7313611097583; 117.388244726634|]
//            [| 29.7321374946370; 91.0054943396277; 80.5046582503149; 0.0; 38.9486841883009; 84.9293824303462; 66.7607669218981; 66.2872536767062; 28.2842712474619; 77.1621668954417; 80.3616824114578; 91.1975876873945; 67.1192967781993; 99.7446740432791; 85.8428797280240; 78.7718223732319; 55.4616984954482; 62.0; 12.0415945787923; 91.0878696644070|]
//            [| 19.1049731745428; 70.7742891168820; 53.7587202228625; 38.9486841883009; 0.0; 54.5893762558247; 35.6931365951495; 30.0832179129826; 33.0605505096331; 61.2943716828878; 48.0936586256442; 73.8241153011670; 52.6307894677631; 65.5133574166368; 61.4003257320350; 51.2445119012758; 21.0950231097290; 46.2276973253049; 31.9061122670876; 72.8971878744304|]
//            [| 73.6817480791546; 109.786155775671; 9.48683298050514; 84.9293824303462; 54.5893762558247; 0.0; 19.0262975904404; 59.0338885725818; 87.5728268357257; 105.948100502085; 7.81024967590665; 115.108644332213; 99.8498873309329; 82.3650411278960; 97.6217188949263; 8.60232526704263; 33.5410196624968; 93.9414711402797; 73.4982993000518; 113.569362065656|]
//            [| 54.7448627726840; 95.6713123146118; 18.8679622641132; 66.7607669218981; 35.6931365951495; 19.0262975904404; 0.0; 45.0; 68.5930025585701; 90.1387818865997; 13.6014705087354; 100.419121685066; 83.2346081867393; 74.0405294416511; 84.0238061504000; 16.1245154965971; 14.8660687473185; 77.1038261048049; 55.7135531087365; 99.0353472251196|]
//            [| 38.1837661840736; 50.9116882454314; 62.9682459657247; 66.2872536767062; 30.0832179129826; 59.0338885725818; 45.0; 0.0; 49.0917508345343; 47.4130783645188; 51.2249938994628; 56.0802995712398; 42.7200187265877; 35.5105618091294; 39.0512483795333; 60.1414998150196; 33.6154726279432; 37.6563407675255; 61.3269924258479; 54.5618914628150|]
//            [|14.0; 63.1981012372998; 86.1220064791805; 28.2842712474619; 33.0605505096331; 87.5728268357257; 68.5930025585701; 49.0917508345343; 0.0; 49.0102030193714; 81.1541742610939; 63.0317380372777; 39.0; 77.8010282708397; 59.2030404624627; 83.7436564761774; 54.1479454827235; 34.2344855372474; 33.1209903233584; 63.0|]
//            [|51.2445119012758; 15.2315462117278; 108.853112036358; 77.1621668954417; 61.2943716828878; 105.948100502085; 90.1387818865997; 47.4130783645188; 49.0102030193714; 0.0; 98.1835016690686; 14.0356688476182; 10.0498756211209; 49.7292670366254; 18.7882942280559; 106.042444332446; 76.3806258157132; 15.8113883008419; 79.8310716450681; 14.0356688476182|]
//            [|67.1863081289633; 101.980390271856; 14.3178210632764; 80.3616824114578; 48.0936586256442; 7.81024967590665; 13.6014705087354; 51.2249938994628; 81.1541742610939; 98.1835016690686; 0.0; 107.298648640139; 92.1791733527699; 75.1332150250474; 89.8276126811795; 12.0415945787923; 27.0185121722126; 86.3133825081603; 69.2892488052800; 105.759160359753|]
//            [|65.0; 7.0; 118.827606220104; 91.1975876873945; 73.8241153011670; 115.108644332213; 100.419121685066; 56.0802995712398; 63.0317380372777; 14.0356688476182; 107.298648640139; 0.0; 24.0831891575846; 49.0102030193714; 18.9736659610103; 116.0; 87.3212459828649; 29.6141857899217; 93.7443331620637; 2.0|]
//            [|41.4366987102013; 24.5153013442625; 102.078401241399; 67.1192967781993; 52.6307894677631; 99.8498873309329; 83.2346081867393; 42.7200187265877; 39.0; 10.0498756211209; 92.1791733527699; 24.0831891575846; 0.0; 52.3259018078045; 24.0831891575846; 99.2975326984513; 69.0289794216893; 6.40312423743285; 69.8569967862919; 24.0|]
//            [|70.2353187506115; 42.0119030752000; 89.0505474435727; 99.7446740432791; 65.5133574166368; 82.3650411278960; 74.0405294416511; 35.5105618091294; 77.8010282708397; 49.7292670366254; 75.1332150250474; 49.0102030193714; 52.3259018078045; 0.0; 31.4006369362152; 86.4060183089118; 66.3701740241805; 51.3127664426700; 96.1353212924365; 47.0106370941726|]
//            [|57.0350769263968; 12.5299640861417; 101.980390271856; 85.8428797280240; 61.4003257320350; 97.6217188949263; 84.0238061504000; 39.0512483795333; 59.2030404624627; 18.7882942280559; 89.8276126811795; 18.9736659610103; 24.0831891575846; 31.4006369362152; 0.0; 99.1564420499243; 71.8679344353238; 25.9422435421457; 86.0; 17.0880074906351|]
//            [|70.0927956355002; 111.036030188403; 2.82842712474619; 78.7718223732319; 51.2445119012758; 8.60232526704263; 16.1245154965971; 60.1414998150196; 83.7436564761774; 106.042444332446; 12.0415945787923; 116.0; 99.2975326984513; 86.4060183089118; 99.1564420499243; 0.0; 30.8706980808663; 93.1933474020544; 67.0820393249937; 114.560027932957|]
//            [|40.1995024844836; 83.0060238777885; 33.5410196624968; 55.4616984954482; 21.0950231097290; 33.5410196624968; 14.8660687473185; 33.6154726279432; 54.1479454827235; 76.3806258157132; 27.0185121722126; 87.3212459828649; 69.0289794216893; 66.3701740241805; 71.8679344353238; 30.8706980808663; 0.0; 62.8012738724303; 45.4862616621766; 86.0523096726636|]
//            [|35.4400902933387; 29.0172362570938; 95.9635347410671; 62.0; 46.2276973253049; 93.9414711402797; 77.1038261048049; 37.6563407675255; 34.2344855372474; 15.8113883008419; 86.3133825081603; 29.6141857899217; 6.40312423743285; 51.3127664426700; 25.9422435421457; 93.1933474020544; 62.8012738724303; 0.0; 64.1326749792959; 29.2745623366089|]
//            [|29.0688837074973; 92.6552750791880; 68.7313611097583; 12.0415945787923; 31.9061122670876; 73.4982993000518; 55.7135531087365; 61.3269924258479; 33.1209903233584; 79.8310716450681; 69.2892488052800; 93.7443331620637; 69.8569967862919; 96.1353212924365; 86.0; 67.0820393249937; 45.4862616621766; 64.1326749792959; 0.0; 93.3809402394300|]
//            [|64.5368112010502; 5.0; 117.388244726634; 91.0878696644070; 72.8971878744304; 113.569362065656; 99.0353472251196; 54.5618914628150; 63.0; 14.0356688476182; 105.759160359753; 2.0; 24.0; 47.0106370941726; 17.0880074906351; 114.560027932957; 86.0523096726636; 29.2745623366089; 93.3809402394300; 0.0|] 
//        |]



    let distanceGenerator cityCount  =        
        // Create n*n distance matrix and fill its elements with random values.
        let distanceMatrix = Array.init cityCount (fun _ ->
            Array.zeroCreate<float> cityCount )        
        
        // Fill matrix elements
        for i = 0 to cityCount-1 do
            for j = i+1 to cityCount-1 do
                // Create random distance
                let d = sqrt((pown (float (x.[i]-x.[j])) 2) + (pown (float (y.[i]-y.[j])) 2));
                // Distance from city[0] to city[0] = 0 and etc...
                // Distance from city[i] to city[j] = Distance from city[j] to city[i]
                distanceMatrix.[i].[j] <- d 
                distanceMatrix.[j].[i] <- d 
        // return distance matrix
        distanceMatrix 

        
    let etaGenerator (distanceMatrix:float[][])  = 
        // Create n*n eta matrix and fill its elements with 1/d.[i].[j] values.
        let heuristicMatrix = Array.map (fun elemArray -> 
            Array.map (fun elem -> (1.0 / (elem )) ) elemArray) distanceMatrix
        // return eta matrix
        heuristicMatrix 


    let tauGenerator cityCount = 
        // Create n*n pheromone matrix and fill its elements with default tah value.
        let pheromoneMatrix = Array.init cityCount (fun _ ->
            Array.init cityCount (fun elem -> Settings.tau))
        // return tau matrix
        pheromoneMatrix 

    let antGenerator antsCount = 
        // Create an population of ants.
        let antPopulation = Array.init antsCount (fun _ -> {Route=[||]; Cost=0.0} )
        // return ant array
        antPopulation 